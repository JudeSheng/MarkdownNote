大数据量的系统的数据库结构如何设计？ 
1、把你表中经常查询的和不常用的分开几个表，也就是横向切分
2、把不同类型的分成几个表，纵向切分
3、常用联接的建索引
4、服务器放几个硬盘，把数据、日志、索引分盘存放，这样可以提高IO吞吐率
5、用优化器，优化你的查询
6、考虑冗余，这样可以减少连接
7、可以考虑建立统计表，就是实时生成总计表，这样可以避免每次查询都统计一次
8、用极量数据测试一下 数据仓库解决的是数据挖掘，共享，和大数据量存储有什么根本关系？
mrzxc 等说的好，考虑你的系统，注意负载平衡，查询优化，25 万并不大，可以建一个表，然后按mrzxc 的3 4 5 7 优化。 速度，影响它的因数太多了，且数据量越大越明显。
1、存储 将硬盘分成NTFS格式，NTFS比FAT32快，并看你的数据文件大小，1G以上你可以采用多数据库文件，这样可以将存取负载分散到多个物理硬盘或磁盘阵列上。
2、tempdb tempdb也应该被单独的物理硬盘或磁盘阵列上,建议放在RAID 0上，这样它的性能最高,不要对它设置最大值让它自动增长
3、日志文件 日志文件也应该和数据文件分开在不同的理硬盘或磁盘阵列上，这样也可以提高硬盘I/O性能。
4、分区视图 就是将你的数据水平分割在集群服务器上，它适合大规模OLTP,SQL群集上，如果你数据库不是访问特别大不建议使用。
5、簇索引 你的表一定有个簇索引，在使用簇索引查询的时候，区块查询是最快的，如用between，应为他是物理连续的，你应该尽量减少对它的updaet,应为这可以使它物理不连续。
6、非簇索引 非簇索引与物理顺序无关，设计它时必须有高度的可选择性，可以提高查询速度，但对表update的时候这些非簇索引会影响速度，且占用空间大，如果你愿意用空间和修改时间换取速度可以考虑。
7、索引视图 如果在视图上建立索引,那视图的结果集就会被存储起来，对与特定的查询性能可以提高很多，但同样对update语句时它也会严重减低性能，一般用在数据相对稳定的数据仓库中。
8、维护索引 你在将索引建好后，定期维护是很重要的，用dbcc showcontig来观察页密度、扫描密度等等，及时用dbcc indexdefrag来整理表或视图的索引,在必要的时候用dbcc dbreindex来重建索引可以受到良好的效果。 不论你是用几个表1、2、3点都可以提高一定的性能，5、6、8点你是必须做的，至于4、7点看你的需求，我个人是不建议的。

大访问量设计注意：
1.    原则即是访问量越大动态信息越少，信息发布系统CMS：息发布系统可以实现最简单的信息录入自动生成静态页面，还能具备频道管理、权限管理、自动抓取等功能
2.    用ACDSEE将图片压缩
3.    除了门户和信息发布类型的网站，对于交互性要求很高的社区类型网站来说，尽可能的静态化也是提高性能的必要手段，将社区内的帖子、文章进行实时的静态化，有更新的时候再重新静态化也是大量使用的策略，像Mop的大杂烩就是使用了这样的策略，网易社区等也是如此。
4.    适当的数据冗余所谓数据冗余就是一份数据在多个地方同时存在。在一般情况下这是不允许的。因为这会带来数据一致性的问题也不符合数据库设计范式。不过在大 流量或者大数据量的网站中部分的数据冗余是能接受的。 比如通常留言和主题是分开存储的。在显示留言的过程中需要显示留言人的名字一般我们会使用join去用户表中获取但是在大流量或大数据量的情况下这样对性 能会存在一定影响。如果在留言表中加入用户名的字段则不再需要去join用户表对性能有一定提升。
5.    数据库集群和库表散列
大型网站都有复杂的应用，这些应用必须使用数据库，那么在面对大量访问的时候，数据库的瓶颈很快就能显现出来，这时一台数据库将很快无法满足应用，于是我们需要使用数据库集群或者库表散列。
在数据库集群方面，很多数据库都有自己的解决方案，Oracle、Sybase 网站制作等都有很好的方案，常用的MySQL提供的Master/Slave也是类似的方案，您使用了什么样的DB，就参考相应的解决方案来实施即可。
上面提到的数据库集群由于在架构、成本、扩张性方面都会受到所采用DB类型的限制，于是我们需要从应用程序的角度来考虑改善系统架构，库表散列是常 用并且最有效的解决方案。我们在应用程序中安装业务和应用或者功能模块将数据库进行分离，不同的模块对应不同的数据库或者表，再按照一定的策略对某个页面 或者功能进行更小的数据库散列，比如用户表，按照用户ID进行表散列，这样就能够低成本的提升系统的性能并且有很好的扩展性。sohu的论坛就是采用了这 样的架构，将论坛的用户、设置、帖子等信息进行数据库分离，然后对帖子、用户按照板块和ID进行散列数据库和表，最终可以在配置文件中进行简单的配置便能 让系统随时增加一台低成本的数据库进来补充系统性能。
6.    
7.    减少css/js/image文件数量网站上 一般都会有很多cssjs等文件。在开发时为了保持文件结构清晰它们都是一个个的。但是在生产环境中应该将它们尽量合并并压缩大小。这样即可以减少 http请求数又可以减少带宽需求。对于小块背景图可以合并成一个然后用background中的位置参数来显示。 如中的图片都在一个文件中只需请求一次即可大大的降低了服务器的负担。
8.    谨慎选择Session和Cookie Session和Cookie是经常使用到的。Session存储在服务端可以存储在文件中也可以存储在数据库中。Cookie存储在客户端每次请求时会发送至服务器。对大流量网站而 言Session也许并不合适因为无论是存储在文件还是数据库在大数据量的情况下性能都不理想。要提高Session的性能可以尝试使用内存数据库来存储 这样效率会比较高。另一种方式就是把信息加密后存储在Cookie中这样无需使用服务器资源但是无论请求什么文件Cookie都将发送至服务器包括图片 cssjs等这会浪费一定量的带宽所以存放在Cookie中的数据应该尽量小也可以通过Cookie作用域来限制Cookie发送到的域名。
9.    合理的缓存策略缓存主要用来减轻数据库的负担有很多种方式比如文件缓存数据库缓存内存缓存等。但是要正确的设置缓存策略否则可能会导致各种错误结果。前段 时间facebook的宕机事故就是因为缓存的处理方面出了问题。以前在做视频网站时因为全文索引比较慢我们对部分数据采用了文件缓存。最开始的时候只是 根据文件的时间是否过期来判断是否需要更新数据后来发现如果同时有多个页面同时更新缓存会造成数据库长时间占用CPU100于是我们设置了一个标志文件当 一个页面更新时创建此文件这时其他页面发现有此文件就不更新继续使用缓存第一个页面更新完成后删除此文件其他页面才可更新。 对一般网站来说程序设计没有什么特殊之处主要就是看设计人员的能力不像网络架构那样有很多通用的解决方案。
10.    第一 负载均衡系统
负载均衡系统分为硬件和软件两种。
硬件负载均衡效率高，但是价格贵，比如F5等。
软件负载均衡系统价格较低或者免费，效率较硬件负载均衡系统低，不过对于流量一般或稍大些网站来讲也足够使用，比如lvs。

1.    镜像网站技术
2.    CDN内容分发网络，新浪网使用ChinaCache CDN服务。
3.    硬件实现 
第 四层交换的硬件实现一般都由专业的硬件厂商作为商业解决方案提供。常见的有Alteon［19］，F5［20］等。这些产品非常昂贵，但是能够提供非常优 秀的性能和很灵活的管理能力。Yahoo中国当初接近2000台服务器使用了三四台Alteon就搞定了［21］。鉴于条件关系，这里不展开讨论。
 软件实现 
第 四层交换也可以通过软件实现，不过性能比专业硬件稍差，但是满足一定量的压力还是可以达到的，而且软件实现配置起来更灵活。 软件四层交换常用的有 Linux上的LVS（Linux Virtual Server），它提供了基于心跳（heart beat）的实时灾难应对解决方案，提高了系统的鲁 棒性，同时提供了灵活的VIP配置和管理功能，可以同时满足多种应用需求［22］。
4.    服务器整体性能考虑
对 于价值昂贵的服务器来说，怎样配置才能发挥它的最大功效，又不至于影响正常的服务，这是在设计网站架构的时候必须要考虑的。常见的影响服务器的处理速度的 因素有：网络连接，硬盘读写，内存空间，CPU速度。如果服务器的某一个部件满负荷运转仍然低于需要，而其他部件仍有能力剩余，我们将之称为性能瓶颈。服 务器想要发挥最大的功效，关键的是消除瓶颈，让所有的部件都被充分的利用起来
5.    Socket优化
6.    图片服务器分离
采用什么架构，才能够承受大访问量 
一般情况下，架构分两种来讨论的，一种是开发架构，一种是部署架构
部署架构，就是开发完的程序在实际运行环境下，通过负载均衡，DNS轮询，SquID等等来减轻单台服务器负载，达到性能优化的目的
这里大家估计更想了解的是开发上的架构
我对这个的观点是，所有的架构都是死的，而性能优化策略是活的，我在开发中，所有的东西都不是一定要按照什么固定的模式，去死开发，更多的是针对需要优化的信息进行针对处理，下面说说我的优化策略
2、程序优化。这个对我来说相对的就不是那么的看中了，程序的优化，我更多的认为是个技巧，而不是架构了，包括现在经常见到的那些各种设计模式，另 外这里提下，很多设计模式，他的出发点并不是性能优化，而是考虑的系统扩展性，所以在单个技术细节上，很多人也发现了，并不如直接的写代码来的快，但是就 是推荐那样，是因为采用了那些模式的程序，扩展性比你的强，那么一旦系统要求变动，或者是要求进行拆分的时候要比你方便的多，在分担到多个服务器上时，性 能相对的就起到了优化也。废话了通，继续说我对程序部分经常采用的方式吧
1） 首推静态化，这个的优化效果不用多说，直接减轻了服务器负担，不过如果用上了Squid，那么有第三放来做静态，也可以达到同样的效果
2） 合适的数据缓存，缓存很多人都用到了，但是在使用前，是否认真思考过为这个这个要进行Cache，Cache他的标准是什么？我说下我的标准：小数据量、 大访问量、更新尽量少的数据，全部可以进行缓存。另外我提到的缓存，并不只是说。NET本身提供的Cache，我说的缓存还包括了使用Static来进行 的数据
3） 活用线程，很多人的观念中感觉线程好象在B/S中是用不到的，或者是没有必要。其实这个观念完全错，在特定情况下使用线程，可以提高的局部性能不是一点两点
4) 功能模块拆分，这个一般人基本都在做，我要补充的是，不只是在单个项目中进行功能模块的拆分，而是为了进行分步式开发而进行拆分
在其它的基本都是细节优化了，这个没有太多兴趣写了，网上资料应该不少，可以自己搜索查阅

上面的这几部分如果能在开发中，灵活运用上，可以说，你开发个CSDN这样规模的站点，绝对不是难事。
我曾经开发的过的站点中，也有过社区，一个WEB 服务器，一个DB服务器，主题帖千万，回复帖有6000W左右吧，其它数据不算，运行过程中没出过任何问题，日访问在100W PV情况下，还没有达到性能瓶颈
缓存是重点，但是缓存要处理的细节很多。延迟、差异性、队列、优先级等等。
交互性强的站点，用事件驱动模型很管用。


数据库集群和应用服务器集群
信息发布系统 CMS

十步构建大型网站架构(1)
http://developer.51cto.com/art/201105/259452.htm
1.    架构演变第一步：物理分离WebServer和数据库
2.    架构演变第二步：增加页面缓存（squid）
3.    架构演变第三步：增加页面片段缓存(ESI)
4.    架构演变第四步：数据缓存
5.    架构演变第五步： 增加WebServer
6.    架构演变第六步：分库
7.    架构演变第七步：分表、DAL和分布式缓存

“国内用户有个很大的特点，付费用户和非付费用户是明确区分的，付费用户不会因为定价10元就不买，非付费用户也不会因为定价1元就买。”
经过这个过程，我也慢慢摸索出另外一条道理：中国的屌丝用户，他们不愿意付费，但他们愿意做任务，愿意点广告，只要你别让他花钱就行。


大流量数据库设计－分布式数据方案
分布式数据方案提供功能如下：
（1）提供分库规则和路由规则（RouteRule简称RR），将上面的说明中提到的三中切分规则直接内嵌入本系统，具体的嵌入方式在接下来的内容中进行详细的说明和论述；
（2）引入集群（Group）的概念，保证数据的高可用性；
（3）引入负载均衡策略（LoadBalancePolicy简称LB）；
（4）引入集群节点可用性探测机制，对单点机器的可用性进行定时的侦测，以保证LB策略的正确实施，以确保系统的高度稳定性；
（5）引入读/写分离，提高数据的查询速度
其中3，4，5是引入集群后衍生而来。

1.    分库
1.1    原因与好处
为了适应数据量的增加，减少单个服务器的负担，使得系统能够随时增加一个廉价的数据库服务器。
1.2    按模块分库
根据功能模块分成多个数据库，每个数据库存放相对独立无依赖的表。
1.3    横向分库
1.3.1    按号段分：
user_id为区分，1～10W的对应DB1，10W～20W的对应DB2。
优点：可部分迁移。缺点：数据分布不均，容易产生“热点”
1.3.2    hash取模分（可以用一致性hash算法）
对user_id进行hash（或者如果user_id是数值型的话直接使用user_id的值也可），然后用一个特定的数字，比如应用中需要将一个数据库切分成4个数据库的话，我们就用4这个数字对user_id的hash值进行取模运算，也就是user_id%4,这样的话每次运算就有四种可能：结果为1的时候对应DB1；结果为2的时候对应DB2；结果为3的时候对应DB3；结果为0的时候对应DB4，这样一来就非常均匀的将数据分配到4个DB中。
优点：数据分布均匀
缺点：数据迁移的时候麻烦（要在开发阶段考虑数据迁移问题）。不能按照机器性能分摊数据（用一致性hash算法的虚拟节点个数来控制，可以解决这个问题）
1.3.3    在认证库中保存数据库配置
就是建立一个DB，这个DB单独保存user_id到DB的映射关系，每次访问数据库的时候都要先查询一次这个数据库，以得到具体的DB信息，然后才能进行我们需要的查询操作。
优点：灵活性强，一对一关系
缺点：每次查询之前都要多一次查询，性能大打折扣
1.4    数据库操作
请求数据层，并传递必要的分库区分字段（通常情况下是user_id）数据层根据区分字段Route到具体的DB在这个确定的DB内进行数据操作。
2.    分表
2.1    原因与好处
提高数据操作的效率，特别是写数据的效率。因为Insert一条数据，会重写索引。
2.2    按数据使用频率分表
2.2.1    纵向切分
比如用户表，常更新的字段为一个表，比如用户的状态。不经常更新的为另一个表，比如用户QQ。这样做完之后，可以在不常更新的表中建立索引，提高查询效率。
2.2.2    横向切分
活跃用户为一个表，非活跃用户为另一个表。当天新建用户为一个单独的表等等。
2.3    数据库操作

3.    Sharding扩容——系统维护不能承受之重
任 何Sharding系统，在上线运行一段时间后，数据就会积累到当前节点规模所能承载的上限，此时就需要对数据库进行扩容了，也就是增加新的物理结点来分 摊数据。如果系统使用的是基于ID进行散列的路由方式，那么团队需要根据新的节点规模重新计算所有数据应处的目标Shard，并将其迁移过去，这对团队来 说无疑是一个巨大的维护负担；而如果系统是按增量区间进行路由(如每1千万条数据或是每一个月的数据存放在一个节点上 )，虽然可以避免数据的迁移，却有可能带来“热点”问题，也就是近期系统的读写都集中在最新创建的节点上(很多系统都有此类特点：新生数据的读写频率明显 高于旧有数据)，从而影响了系统性能。面对这种两难的处境，Sharding扩容显得异常困难。

